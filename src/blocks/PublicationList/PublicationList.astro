---
import { getDehydratedState } from '@lib/react-query';
import {
  PublicationList as PublicationListComponent,
  loader,
} from './PublicationList.tsx';

const referer = Astro.request.headers.get('Referer');
const url = referer ? new URL(referer) : Astro.url;

const searchParams = url.searchParams;
const initialParams = {
  zoek: searchParams.get('zoek') ?? '',
  tag: searchParams.get('tag') ?? '',
  page: searchParams.get('page') ?? '1',
};
const initialData = await loader(initialParams);
const initialUrl = url.href;
---

<PublicationListComponent
  client:load
  initialParams={initialParams}
  initialState={getDehydratedState(
    ['publications', initialParams],
    initialData
  )}
  initialUrl={initialUrl}
/>
